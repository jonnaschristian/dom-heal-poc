
# POC ‚Äî DOM-Heal

**Prova de Conceito: Self-Healing de elementos do DOM**

Este reposit√≥rio apresenta uma POC (Prova de Conceito) para validar a biblioteca `dom-heal`, demonstrando como ela pode ser integrada e utilizada em quaisquer frameworks de testes automatizados a partir de cen√°rios reais e controlados. Para uma valida√ß√£o controlada, foram definidos tr√™s principais e diferentes frameworks de testes - Cypress, Robot Framework e Selenium.



## üéØ Objetivos da POC

- Demonstrar a capacidade da biblioteca DOM-Heal em identificar e corrigir automaticamente seletores quebrados ap√≥s mudan√ßas no front-end;

- Validar que a abordagem √© agn√≥stica ao framework: funciona com qualquer su√≠te de testes web que consome arquivos JSON de elementos.



## üóÇÔ∏è Estrutura do Projeto

```
dom-heal-poc/
‚îú‚îÄ‚îÄ Cypress/
‚îÇ   ‚îú‚îÄ‚îÄ e2e/         # Testes automatizados Cypress
‚îÇ   ‚îî‚îÄ‚îÄ fixtures/    # Arquivos JSON de seletores usados nos testes
‚îÇ   ‚îî‚îÄ‚îÄ support/     # Arquivos de suporte para os testes automatizados
‚îÇ
‚îú‚îÄ‚îÄ RobotFramework/
‚îÇ   ‚îú‚îÄ‚îÄ elements/    # Arquivos JSON de seletores usados nos testes
‚îÇ   ‚îî‚îÄ‚îÄ tests/       # Testes automatizados Robot Framework
‚îÇ
‚îú‚îÄ‚îÄ Selenium/
‚îÇ   ‚îú‚îÄ‚îÄ elements/    # Arquivos JSON de seletores usados nos testes
‚îÇ   ‚îî‚îÄ‚îÄ tests/       # Testes automatizados Selenium
‚îÇ
‚îî‚îÄ‚îÄ Sites
    ‚îú‚îÄ‚îÄ A/dist       # Site de refer√™ncia original
    ‚îú‚îÄ‚îÄ B/dist       # Site alterado propositalmente (quebra seletores)
```



## üß™ Frameworks de Teste

A POC inclui o mesmo cen√°rio de teste implementado nos tr√™s principais frameworks de automa√ß√£o web:
- **Cypress:** Testes escritos em JavaScript, usando os seletores armazenados nos fixtures JSON.
- **Robot Framework:** Testes em linguagem tabular, tamb√©m utilizando arquivos JSON de seletores.
- **Selenium (Python):** Testes Python, lendo os seletores de arquivos JSON.

> Todos os frameworks consomem os mesmos arquivos de seletores, refor√ßando a abordagem universal do DOM-Heal.



## üï∏Ô∏è Sites A e B

- **Site A:** √â a vers√£o base/original. Os arquivos HTML/CSS/JS aqui representam o funcionamento esperado do sistema ‚Äî √© a refer√™ncia dos testes.
- **Site B:** √â uma vers√£o com pequenas mudan√ßas nos atributos dos elementos (id, class, name, etc), simulando mudan√ßas t√≠picas de manuten√ß√£o/evolu√ß√£o de front-end e **quebrando** intencionalmente alguns seletores.

> **O objetivo √© simular um cen√°rio real: ao migrar os testes para o site B, alguns testes falham pois os seletores antigos n√£o existem mais.**



## üöÄ **Como Executar a POC ‚Äì Passo a Passo**

### 1. **Clone ou Baixe o Reposit√≥rio**

Clone este reposit√≥rio com o comando:

```bash
git clone https://github.com/jonnaschristian/dom-heal-poc.git
```

Ou [baixe o ZIP aqui](https://github.com/jonnaschristian/dom-heal-poc/archive/refs/heads/master.zip).


### 2. **Pr√©-requisitos**

- **Python 3.13.0 ou superior**  
  - Fa√ßa o download em:  
    [Download Python](https://www.python.org/downloads/)

  - Ap√≥s instalar, verifique a vers√£o:

    ```bash
    python --version
    ```
  - Recomendado criar um ambiente virtual:

    ```bash
    python -m venv venv
    ```
  - Ative o ambiente virtual:

      ```bash
      venv\Scripts\activate
      ```

- **Node.js 22.15.0 ou superior**
  - Fa√ßa o download em:  
  [Download Node.js](https://nodejs.org/)
  
  - Verifique a vers√£o:
    ```bash
    node --version
    ```

- **Google Chrome**
  - Fa√ßa o download em:  
  [Download Chrome](https://www.google.com/chrome/)

- **WebDriver (ChromeDriver)**
  - J√° est√° incluso no projeto: n√£o precisa instalar nem baixar nada extra.
  - O arquivo est√° em: `chromedriver-win64/chromedriver.exe`
  - Usado automaticamente nos testes Robot Framework e Selenium.
  - **Obrigat√≥rio:** Ter o Google Chrome instalado.

- **Cypress e depend√™ncias**
  - Todas as bibliotecas necess√°rias (`cypress`, `@faker-js/faker`, `cypress-xpath`) j√° est√£o declaradas no arquivo `package.json`.
  - Na raiz do projeto, rode:

    ```bash
    npm install
    ```
  - **Importante:** Sempre execute esse comando na raiz do projeto, e n√£o dentro da pasta `cypress/`.

- **Robot Framework e depend√™ncias**  

   Instale todas as bibliotecas necess√°rias com:

    ```bash
    pip install robotframework
    pip install robotframework-seleniumlibrary
    pip install robotframework-jsonlibrary
    ```

- **Selenium e depend√™ncias**

   Instale tudo o que precisa com:

    ```bash
    pip install selenium pytest
    ```


### 3. **Instale a biblioteca DOM-Heal**

   Com o ambiente virtual ativo, instale a biblioteca self-healing DOM-Heal:

   ```bash
   pip install dom-heal
   ```


### 4. **Inicie os Ambientes dos Sites A e B**

Antes de rodar qualquer teste, √© necess√°rio subir os servidores locais dos sites A e B em portas diferentes.
- #### **Inicie o servidor local do Site A**
   1. Abra um terminal e navegue at√© a pasta `dist` do Site A:

      ```bash
      cd Sites/A/dist
      ```
   2. Execute o servidor local na porta 8000:

      ```bash
      python -m http.server 8000
      ```
   3. O Site A ficar√° dispon√≠vel em:

      ```bash
      http://localhost:8000/home.html
      ```
   
- #### **Inicie o servidor local do Site B**
   1. Abra outro terminal e navegue at√© a pasta `dist` do Site B:

      ```bash
      cd Sites/B/dist
      ```
   2. Execute o servidor local na porta 8001:

      ```bash
      python -m http.server 8001
      ```
   3. O Site B ficar√° dispon√≠vel em:

      ```bash
      http://localhost:8001/home.html
      ```




### 5. **Execute os Testes Automatizados**
> **Contextualiza√ß√£o:**  
> Os testes de automa√ß√£o est√£o inicialmente configurados para rodar sobre o **Site A**.  
> Dessa forma, **todos os testes devem passar sem erro** nos frameworks, validando que a base do projeto est√° funcionando corretamente.
>
> Caso algum teste falhe neste est√°gio, verifique as depend√™ncias e a estrutura do projeto, pois todos os seletores e fluxos est√£o alinhados com o Site A.
>
> Siga os passos abaixo para executar cada su√≠te de teste:

- #### **A) Testes com Cypress**

   1. Abra o Cypress:

         **Na raiz do projeto**, execute:
         ```bash
         npx cypress open
         ```
         Isso abrir√° a interface gr√°fica do Cypress, onde voc√™ pode selecionar e rodar os testes manualmente (os arquivos ficam em `cypress/e2e`).

   2. Observa√ß√µes:
      - No modo visual, clique sobre cada arquivo de teste para execut√°-lo e ver os resultados no navegador.
      - N√£o altere a estrutura da pasta `cypress/`, pois os testes esperam esse caminho padr√£o.
      - Se algum erro de depend√™ncia aparecer, repita `npm install` na raiz do projeto.
      - **Sempre execute os comandos acima na raiz do projeto (onde est√° o arquivo `package.json`).**

- #### **B) Testes com Robot Framework**

   1. Execute todos os testes Robot Framework:

         **Na raiz do projeto**, execute:
         ```bash
         robot RobotFramework/tests/
         ```
         Isso executar√° todos os testes `.robot` da su√≠te, utilizando o ChromeDriver j√° inclu√≠do no projeto.

   2. Observa√ß√µes:
      - Os resultados aparecer√£o no terminal e um relat√≥rio detalhado ser√° gerado nas pastas `log.html` e `report.html`.
      - Sempre execute o comando a partir da raiz do projeto para garantir que o caminho do ChromeDriver seja reconhecido automaticamente.
      - N√£o altere a estrutura das pastas, nem mova os arquivos do `RobotFramework/tests/`.
      - Se houver erro relacionado ao driver, verifique se o Google Chrome est√° instalado e o arquivo `chromedriver.exe` est√° na pasta correta.

- #### **C) Testes com Selenium**

   1. Execute todos os testes Selenium:

         **Na raiz do projeto**, execute:
         ```bash
         pytest Selenium/tests/
         ```
         Isso executar√° todos os testes automatizados com Selenium, utilizando o ChromeDriver incluso no projeto.

   2. Observa√ß√µes:
      - Os resultados dos testes aparecer√£o diretamente no terminal.
      - Sempre execute o comando a partir da raiz do projeto para garantir que o caminho do ChromeDriver seja reconhecido automaticamente.
      - N√£o altere a estrutura das pastas, nem mova os arquivos do `Selenium/tests/`.
      - Se houver erro relacionado ao driver, verifique se o Google Chrome est√° instalado e o arquivo `chromedriver.exe` est√° na pasta correta.





### 6. **Simulando quebra de testes**

1. Altere o alvo dos testes para o **Site B** (estrutura com atributos modificados).
2. Execute os testes novamente. Alguns devem falhar devido a seletores desatualizados.
3. Rode o DOM-Heal para atualizar os seletores automaticamente:
    ```bash
    dom-heal rodar --json ./Cypress/fixtures/home.json --url http://localhost:8000/siteB/home.html
    ```
4. Valide que o arquivo JSON foi atualizado e rode novamente os testes ‚Äì agora devem passar mesmo ap√≥s as mudan√ßas no DOM.

---

### 7. **(Opcional) Assista ao tutorial em v√≠deo**

Assista ao passo a passo em v√≠deo:  
[Coloque o link aqui ap√≥s gravar]

---

## ‚ÑπÔ∏è **Dicas e Observa√ß√µes**

- Cada framework possui sua pr√≥pria pasta de seletores (sempre formato JSON).
- Recomenda-se usar um arquivo de seletores por p√°gina.
- A biblioteca DOM-Heal √© chamada externamente, via CLI.

---

## ‚ùì **D√∫vidas Frequentes**

- **Erro ao instalar depend√™ncias?**  
  Verifique as vers√µes do Python/Node.js e se est√° no diret√≥rio correto.

- **Problemas ao rodar comandos?**  
  Confira se est√° no ambiente virtual e se todas as depend√™ncias foram instaladas.

- **N√£o sabe por onde come√ßar?**  
  Siga o passo a passo acima ou assista ao v√≠deo do tutorial.


---

## üï∏Ô∏è Sites A e B

- **Site A:** √â a vers√£o base/original. Os arquivos HTML/CSS/JS aqui representam o funcionamento esperado do sistema ‚Äî √© a refer√™ncia dos testes.
- **Site B:** √â uma vers√£o com pequenas mudan√ßas nos atributos dos elementos (id, class, name, etc), simulando mudan√ßas t√≠picas de manuten√ß√£o/evolu√ß√£o de front-end e **quebrando** intencionalmente alguns seletores.

> **O objetivo √© simular um cen√°rio real: ao migrar os testes para o site B, alguns testes falham pois os seletores antigos n√£o existem mais.**

---

## üß™ Frameworks de Teste

A POC inclui o mesmo cen√°rio de teste implementado nos tr√™s principais frameworks de automa√ß√£o web:

- **Cypress:** Testes escritos em JavaScript, usando os seletores armazenados nos fixtures JSON.
- **Robot Framework:** Testes em linguagem tabular, tamb√©m utilizando arquivos JSON de seletores.
- **Selenium (Python):** Testes Python, lendo os seletores de arquivos JSON.

> Todos os frameworks consomem os mesmos arquivos de seletores, refor√ßando a abordagem universal do DOM-Heal.

---

## ‚öôÔ∏è Fluxo de Uso/Revalida√ß√£o

1. **Execute os testes automatizados no Site A**  
   (devem passar, j√° que os seletores batem com o DOM atual)

2. **Altere o alvo dos testes para o Site B**  
   (alguns testes v√£o falhar, pois os seletores est√£o desatualizados)

3. **Rode o DOM-Heal passando o JSON e a URL do Site B**  
   ```bash
   dom-heal rodar --json ./Cypress/fixtures/home.json --url http://localhost:8000/siteB/home.html
   ```

4. **Valide que o JSON foi atualizado**  
   O arquivo agora cont√©m os seletores ajustados para o Site B.  
   O log de altera√ß√µes detalha o que mudou.

5. **Rode novamente os testes com o JSON atualizado**  
   (Os testes devem passar mesmo com as altera√ß√µes do front-end, sem necessidade de interven√ß√£o manual)

---

## üìù Observa√ß√µes Importantes

- **Cada framework tem sua pr√≥pria pasta de elementos/fixtures, mas o formato √© sempre JSON**.
- √â fundamental usar um arquivo de seletores por p√°gina para facilitar o controle das altera√ß√µes.
- A biblioteca DOM-Heal √© externa ao projeto de testes: pode ser chamada como CLI ou integrada via adapta√ß√£o.

---

## üë®‚Äçüíª Requisitos

- Node.js (para Cypress)
- Python 3.7+ (para Robot e Selenium)
- Google Chrome instalado localmente

---

## üßë‚Äçüè´ Autor

Prova de Conceito por **Jonnas Christian Sousa de Paiva**  
Contato: [jonnaschristian@gmail.com](mailto:jonnaschristian@gmail.com)

---
